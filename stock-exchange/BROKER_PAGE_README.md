# Страница брокера - Инструкция по запуску

## Что было реализовано

Реализована страница брокера со следующим функционалом:

### Отображение информации:
- ✅ Текущая имитируемая дата
- ✅ Текущая стоимость каждой акции на торгах
- ✅ Общее количество доступных средств
- ✅ Количество, стоимость и прибыль/убыток по каждой купленной акции

### Функциональность:
- ✅ Диалоговое окно с графиком изменения цены акций
- ✅ Покупка/продажа акций
- ✅ Проверка достаточности средств
- ✅ Мгновенная купля/продажа
- ✅ Real-time обновления цен через WebSocket

## Установка зависимостей

### Серверная часть (NestJS)
```bash
cd server
npm install
```

### Клиентская часть (Vue + Vuetify)
```bash
cd client
npm install
```

## Запуск приложения

### 1. Запуск сервера
```bash
cd server
npm run start:dev
```
Сервер будет доступен на `http://localhost:3000`

### 2. Запуск клиента
```bash
cd client
npm run dev
```
Клиент будет доступен на `http://localhost:5173` (или другой порт, указанный в консоли)

## Использование

1. Откройте браузер и перейдите на страницу клиента
2. Перейдите на страницу брокера (например, `/broker/1`)
3. На странице отобразится:
   - Информационная панель с балансом и статистикой
   - Таблица всех доступных акций
   - Ваш портфель с купленными акциями
   - Индикатор WebSocket подключения

### Действия:
- **График**: Нажмите кнопку "График" для просмотра истории цен
- **Купить**: Укажите количество и купите акции (если хватает средств)
- **Продать**: Продайте имеющиеся акции

## Особенности реализации

### Серверная часть:
- `/stocks` - получение списка акций
- `/stocks/:symbol/history` - история цен акции
- `/brokers/:id/buy` - покупка акций
- `/brokers/:id/sell` - продажа акций
- WebSocket на `/ws` - real-time обновления цен

### Клиентская часть:
- Vue 3 Composition API
- Vuetify для UI компонентов
- Chart.js для графиков
- Socket.io-client для WebSocket
- Автоматическое обновление цен каждые 10 секунд

### Валидация:
- ❌ Нельзя купить акции без достаточных средств
- ❌ Нельзя продать больше акций, чем есть в портфеле
- ✅ Все операции происходят мгновенно

## Структура файлов

### Новые/измененные файлы:

**Client:**
- `client/src/interfaces/Stock.ts` - интерфейсы для акций
- `client/src/pages/BrokerPage.vue` - главная страница брокера
- `client/src/shared/components/StockChartDialog.vue` - диалог графика
- `client/src/shared/services/socketService.ts` - сервис WebSocket

**Server:**
- `server/src/stocks/stocks.service.ts` - логика работы с акциями
- `server/src/stocks/stocks.controller.ts` - API endpoints для акций
- `server/src/brokers/brokers.service.ts` - добавлены методы buy/sell
- `server/src/brokers/brokers.controller.ts` - endpoints для торговли
- `server/src/socket/socket.service.ts` - WebSocket gateway
- `server/src/socket/socket.module.ts` - модуль WebSocket

## Примечания

- Цены акций изменяются случайным образом каждые 10 секунд (от -5% до +5%)
- Начальные акции: AAPL, GOOGL, MSFT, AMZN, TSLA
- Данные брокеров хранятся в `server/data/brokers.json`
